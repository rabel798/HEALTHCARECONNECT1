<!DOCTYPE html>
<html>
<head>
    <title>Doctor Prescription - {{ prescription.patient.full_name }}</title>
    <style>
        @media print {
            @page {
                size: A4;
                margin: 0.8cm;
            }
            body { 
                font-family: 'Arial', sans-serif;
                margin: 0;
                padding: 20px;
                line-height: 1.6;
                color: #333;
                font-size: 13px;
                min-height: 100vh;
                display: flex;
                flex-direction: column;
                background-image: 
                    radial-gradient(circle at 20% 20%, rgba(26, 115, 232, 0.08) 0%, transparent 50%),
                    radial-gradient(circle at 80% 80%, rgba(26, 115, 232, 0.06) 0%, transparent 50%),
                    radial-gradient(circle at 40% 40%, rgba(26, 115, 232, 0.04) 0%, transparent 50%),
                    linear-gradient(135deg, rgba(26, 115, 232, 0.03) 0%, rgba(26, 115, 232, 0.05) 50%, rgba(26, 115, 232, 0.03) 100%);
                background-size: 200px 200px, 150px 150px, 100px 100px, 100% 100%;
                background-repeat: repeat, repeat, repeat, no-repeat;
                position: relative;
            }
            body::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Cg fill-opacity='0.04' fill='%231a73e8'%3E%3Cpath d='M40 10c16.569 0 30 13.431 30 30S56.569 70 40 70 10 56.569 10 40 23.431 10 40 10zm0 8c-12.15 0-22 9.85-22 22s9.85 22 22 22 22-9.85 22-22-9.85-22-22-22z'/%3E%3Cpath d='M40 20c11.046 0 20 8.954 20 20s-8.954 20-20 20-20-8.954-20-20 8.954-20 20-20zm0 4c-8.837 0-16 7.163-16 16s7.163 16 16 16 16-7.163 16-16-7.163-16-16-16z'/%3E%3Cpath d='M40 32a8 8 0 1 1 0 16 8 8 0 0 1 0-16z'/%3E%3C/g%3E%3C/svg%3E");
                background-size: 80px 80px;
                background-repeat: repeat;
                pointer-events: none;
                z-index: -1;
            }
            body::after {
                content: 'Dr. Richa\'s Eye Clinic';
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) rotate(-45deg);
                font-size: 48px;
                font-weight: bold;
                color: rgba(26, 115, 232, 0.03);
                font-family: 'Arial', sans-serif;
                white-space: nowrap;
                pointer-events: none;
                z-index: -1;
                text-transform: uppercase;
                letter-spacing: 8px;
            }
            .header {
                text-align: center;
                padding: 20px 0;
                border-bottom: 2px solid #1a73e8;
                margin-bottom: 30px;
                position: relative;
                z-index: 1;
                background-color: rgba(255, 255, 255, 0.9);
            }
            .header h1 {
                color: #1a73e8;
                margin: 0;
                font-size: 24px;
            }
            .clinic-info {
                font-size: 14px;
                color: #666;
                margin-top: 10px;
            }
            .patient-info {
                background: rgba(248, 249, 250, 0.95);
                padding: 20px;
                border-radius: 8px;
                margin-bottom: 30px;
                position: relative;
                z-index: 1;
            }
            .findings-section {
                display: flex;
                justify-content: space-between;
                margin: 20px 0;
                gap: 20px;
            }
            .eye-findings {
                flex: 1;
                border: 1px solid #dee2e6;
                padding: 15px;
                border-radius: 8px;
            }
            .section-title {
                color: #1a73e8;
                font-size: 16px;
                font-weight: bold;
                margin-bottom: 10px;
                border-bottom: 1px solid #dee2e6;
                padding-bottom: 5px;
            }
            .additional-notes {
                margin: 20px 0;
                border: 1px solid #dee2e6;
                padding: 15px;
                border-radius: 8px;
            }
            .footer {
                margin-top: 50px;
                text-align: right;
                border-top: 1px solid #dee2e6;
                padding-top: 20px;
            }
            .signature {
                font-weight: bold;
                color: #1a73e8;
                font-size: 14px;
            }
            .no-print {
                display: none;
            }
            p {
                margin: 4px 0;
                font-size: 13px;
            }
            .patient-info p {
                font-size: 13px;
            }
            .eye-findings p {
                font-size: 13px;
            }
            .additional-notes p {
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Dr. Richa's Eye Clinic</h1>
        <div class="clinic-info">
            First floor, DVR Town Centre, near to IGUS private limited,<br>
            Mandur, Budigere Road (New Airport Road),<br>
            Bengaluru, Karnataka 560049
        </div>
    </div>

    <div class="patient-info">
        <div class="section-title">Patient Information</div>
        <p><strong>Name:</strong> {{ prescription.patient.full_name }}</p>
        <p><strong>Age:</strong> {{ prescription.patient.age }} years</p>
        <p><strong>Contact:</strong> {{ prescription.patient.mobile_number }}</p>
        <p><strong>Date:</strong> {{ prescription.prescription_date.strftime('%d %B, %Y') }}</p>
    </div>

    <div class="prescription-content">
                {% if prescription.complaints %}
                <div class="section">
                    <h4>Chief Complaints:</h4>
                    <p>{{ prescription.complaints }}</p>
                </div>
                {% endif %}

                {% if prescription.history %}
                <div class="section">
                    <h4>History:</h4>
                    <p>{{ prescription.history }}</p>
                </div>
                {% endif %}

                {% if prescription.examination_notes %}
                <div class="section">
                    <h4>Examination Notes:</h4>
                    <p>{{ prescription.examination_notes }}</p>
                </div>
                {% endif %}

                <div class="section">
                    <h4>Diagnosis:</h4>
                    <p>{{ prescription.diagnosis }}</p>
                </div>

                {% if prescription.left_eye_findings or prescription.right_eye_findings %}
                <div class="section">
                    <h4>Eye Examination Findings:</h4>
                    {% if prescription.left_eye_findings %}
                    <p><strong>Left Eye:</strong> {{ prescription.left_eye_findings }}</p>
                    {% endif %}
                    {% if prescription.right_eye_findings %}
                    <p><strong>Right Eye:</strong> {{ prescription.right_eye_findings }}</p>
                    {% endif %}
                </div>
                {% endif %}

                {% if prescription.investigation %}
                <div class="section">
                    <h4>Investigation:</h4>
                    <p>{{ prescription.investigation }}</p>
                </div>
                {% endif %}

                <div class="section">
                    <h4>Medications:</h4>
                    <p>{{ prescription.medications }}</p>
                </div>

                {% if prescription.prognosis %}
                <div class="section">
                    <h4>Prognosis:</h4>
                    <p>{{ prescription.prognosis }}</p>
                </div>
                {% endif %}

                {% if prescription.nutritional_advice %}
                <div class="section">
                    <h4>Nutritional Advice:</h4>
                    <p>{{ prescription.nutritional_advice }}</p>
                </div>
                {% endif %}

                {% if prescription.plan_of_care %}
                <div class="section">
                    <h4>Plan of Care:</h4>
                    <p>{{ prescription.plan_of_care }}</p>
                </div>
                {% endif %}

                <div class="section">
                    <h4>Instructions:</h4>
                    <p>{{ prescription.instructions }}</p>
                </div>

                {% if prescription.follow_up %}
                <div class="section">
                    <h4>Follow-up:</h4>
                    <p>{{ prescription.follow_up }}</p>
                </div>
                {% endif %}

                {% if prescription.referral_reason %}
                <div class="section">
                    <h4>Referral Reason:</h4>
                    <p>{{ prescription.referral_reason }}</p>
                </div>
                {% endif %}

                {% if prescription.referred_to_cc %}
                <div class="section">
                    <h4>Referred to:</h4>
                    <p>{{ prescription.referred_to_cc }}</p>
                </div>
                {% endif %}

                {% if prescription.comments %}
                <div class="section">
                    <h4>Comments:</h4>
                    <p>{{ prescription.comments }}</p>
                </div>
                {% endif %}

                {% if prescription.remarks_for_counselor %}
                <div class="section">
                    <h4>Remarks for Counselor:</h4>
                    <p>{{ prescription.remarks_for_counselor }}</p>
                </div>
                {% endif %}
            </div>

    

    <div class="footer">
        <p class="signature">{{ current_user.full_name }}</p>
        <p>MBBS, MS, FPOS<br>
        Dr. Richa's Eye Clinic</p>
    </div>

    <div class="no-print text-center mt-4">
        <button onclick="window.print()" class="btn btn-primary">Print Prescription</button>
    </div>
</body>
</html>